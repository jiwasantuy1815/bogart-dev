(()=>{"use strict";const e=window.React,t=window.wp.hooks,n=window.wp.compose,r=window.wp.element,o=(window.wp.components,window.wp.i18n),i=(window.wp.data,window.wp.coreData,(0,n.createHigherOrderComponent)((t=>n=>{const{clientId:r,tabName:i,blockName:l}=n,{getAttributes:c,setAttributes:a}=window?.gutenkit?.helpers,{GkitPanelBody:s,GkitSwitcher:u,GkitText:d,GkitSelect:m,GkitMedia:f,GkitSlider:g}=window.gutenkit.components,k=c(r);return(0,e.createElement)(e.Fragment,null,"advanced"===i&&"gutenkit/nav-menu"==l?(0,e.createElement)(t,{...n},(0,e.createElement)(s,{title:(0,o.__)("Scroll Spy","gutenkit-blocks-addon-pro"),initialOpen:!1},(0,e.createElement)(u,{label:(0,o.__)("Enable ScrollSpy","gutenkit-blocks-addon-pro"),value:k?.isScrollSpyEnabled,onChange:e=>a(r,{isScrollSpyEnabled:e})}),k?.isScrollSpyEnabled&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(g,{label:(0,o.__)("Offset","gutenkit-blocks-addon-pro"),value:k?.scrollToOffset,onChange:e=>a(r,{scrollToOffset:e}),range:{max:1e3,min:0}}))),n.children):(0,e.createElement)(t,{...n},n.children))}),"ScrollSpySettings"));const l=(0,n.createHigherOrderComponent)((t=>n=>{if(n?.name?.includes("gutenkit")){const{useDeviceList:o,useModuleStyles:i,hasCSS:l}=window?.gutenkit?.helpers,{GkitStyle:c}=window.gutenkit.components,{attributes:a,setAttributes:s,clientId:u,isSelected:d}=(o(),n||{});return(0,r.useEffect)((()=>{if(a?.isScrollSpyEnabled){const e=function(e,t=0){const{document:n}=e||{};let r=!1,o=[];function i(){n.querySelectorAll(".wp-block-gutenkit-nav-menu-item a").forEach((e=>{const t=e.getAttribute("href");if(t&&(t.startsWith("#")||t.startsWith("."))&&function(e){try{return n.querySelector(e),!0}catch(e){return!1}}(t)){const e=n.querySelector(t);e&&(e.dataset.href=t,function(e){const t=new IntersectionObserver((e=>{r||e.forEach((e=>{if(e.isIntersecting){const t=e.target.getAttribute("data-href");c(e.target,t)}}))}),{rootMargin:"-50% 0%"});t.observe(e),o.push(t)}(e))}}))}function l(o){o.preventDefault();const l=o.currentTarget.getAttribute("href"),a=n.querySelector(l);if(a){const n=a.getBoundingClientRect().top+e.scrollY-(t?.size||0);e.scrollTo({top:n,behavior:"smooth"}),c(0,l),r=!0,setTimeout((()=>{r=!1,e.addEventListener("scroll",i)}),1e3)}}function c(e,t=""){if(!t)return;const r=n.querySelectorAll(`.wp-block-gutenkit-nav-menu a[href="${t}"]`);if(0===r.length)return;const o=n.querySelectorAll(".wp-block-gutenkit-nav-menu li");o.length>0&&o.forEach((e=>{e.classList.remove("gkit-nav-menu-item-active")})),r.forEach((e=>{const t=e.closest("li");t&&t.classList.add("gkit-nav-menu-item-active")}))}return i(),n.querySelectorAll('.wp-block-gutenkit-nav-menu-item a[href^="."], .wp-block-gutenkit-nav-menu-item a[href^="#"]').forEach((e=>e.addEventListener("click",l))),function(){o.forEach((e=>e.disconnect())),o=[],n.querySelectorAll('.wp-block-gutenkit-nav-menu-item a[href^="."], .wp-block-gutenkit-nav-menu-item a[href^="#"]').forEach((e=>{e.removeEventListener("click",l)})),e.removeEventListener("scroll",i),n.querySelectorAll(".gkit-nav-menu-item-active").forEach((e=>e.classList.remove("gkit-nav-menu-item-active")))}}(window.frames["editor-canvas"]||window,a?.scrollToOffset);return()=>e()}}),[a?.isScrollSpyEnabled,a?.scrollToOffset]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t,{...n}))}return(0,e.createElement)(t,{...n})}),"ScrollSpyEdit");(0,t.addFilter)("gutenkit.tabs.after-tab","gutenkit/scroll-spy/controls",i,10),(0,t.addFilter)("editor.BlockEdit","gutenkit/scroll-spy/edit",l,10)})();